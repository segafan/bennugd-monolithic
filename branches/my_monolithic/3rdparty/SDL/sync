#!/bin/bash

# SDL directory location, change to your system's location
SDLDIR="../../../SDL"

################################################################################
# Don't change anything below this line                                        #
################################################################################
CURDIR="$(pwd $0)"

# Update SDL code
cd "$SDLDIR"
echo "Updating SDL source code, changes will be reverted"
echo "=================================================="
hg revert -a
hg pull
hg update -v

# Update the local copy
echo "BEWARE: You local modifications to SDL will get lost"
echo "===================================================="
export IFS=$(echo -en "\n\b")
FILES=$(find -iname "*" | grep -v ".hg")
cd "$CURDIR"
for i in $FILES; do
    # If the file is already there, just copy it and assume it's already
    # under version control
    if [ -f "$i" ]; then
        cp "$SDLDIR/$i" "$i";
    else
        # Copy the file/dir and add it to VCS
        if [ -f "$SDLDIR/$i" ]; then
            cp "$SDLDIR/$i" "$i";
            svn add "$i"
        elif [ -d "$SDLDIR/$i" ] && ! [ -d "$i" ]; then
            mkdir -p "$i"
            svn add "$i"
        fi;
    fi;
done
